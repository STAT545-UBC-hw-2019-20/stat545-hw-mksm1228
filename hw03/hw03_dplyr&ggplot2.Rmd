---
title: "hw03_dplyr&ggplot2"
output: 
  github_document:
    keep_md: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, echo=FALSE, message=FALSE}
library(gapminder)
library(tidyverse)
library(scales)
library(tsibble)
library(DT)
library(knitr)
library(kableExtra)
library(ggplot2)
```

<style type="text/css">
.twoC {width: 100%}
.clearer {clear: both}
.twoC .table {max-width: 10%; float: left}
.twoC img {max-width: 45%; float: right}
</style>
<!-- Code derived from https://gist.github.com/jennybc/e9e9aba6ba18c72cec26#file-2015-03-02_plot-next-to-table-rmd -->

<div class="twoC">
##### **Task Option 2: Max and Min GDP Per Capita within the Continents**

---------------------

```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  group_by(continent) %>%
  summarize(Min = min(gdpPercap), Max = max(gdpPercap)) %>%
  kable(., format = "html", caption = "Min and Max GDP Per Capita within the
  Continents") %>%
  kable_styling(full_width = F)
```


```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  group_by(continent) %>%
  summarize(Min = min(gdpPercap), Max = max(gdpPercap)) %>%
  ggplot(., aes(continent, Min))+
  geom_point(color = "red", size = 5)+
  geom_point(aes(continent, Max), color = "blue", size = 5)+
  scale_y_log10(labels = scales::dollar_format())+
  ylab("GDP Per Capita (US$)")+
  xlab("Continents")+
  ggtitle("Maximum and Minimum of GDP Per Capita for All Continents")+
  theme_bw()
```
</div>
<div class="clearer"></div>

The table and figure above shows the minimum and maximum GDP Per Capita within each continent from all the years recorded. Red represents the minimum GDP Per Capita. Blue represents the maximum GDP Per Capita. This graph shows that Africa has the smallest minimum GDP Per Capita compared to the minimum GDP Per Capita of other other continents. In terms of maximum GDP Per Capita, Asia has the largest maximum GDP Per Capita compared to the other continents. 


<div class = "twoC">

##### **Task Option 3: Spread of GDP Per Capita Within the Continents** 

---------------------

```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  group_by(continent) %>%
  summarize(median = median(gdpPercap), SD = sd(gdpPercap),  
  MedAbsdev = mad(gdpPercap), InQuartRange = 
  IQR(gdpPercap)) %>%
  kable(., format = "html", caption = 
  "Spread of GDP Per Capita Within the Continents")%>%
  kable_styling(full_width = F)
```

```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  group_by(continent) %>%
  ggplot(., aes(continent, gdpPercap))+
  geom_boxplot()+
  scale_y_log10("GDP Per Capita (US$)", 
  labels = scales::dollar_format())+
  xlab("Continent")+
  ggtitle("Spread of GDP Per Capita within the Continents")+
  theme_bw()
```
</div>
<div class="clearer"></div>

The table and figure above shows the spread of GDP Per Capita within each continent using a boxplot. GDP Per Capita is on a log10 scale. From the figure we can see that Asia had the largest spread of GDP Per Capita. In contrast, Africa had the smallest spread of GPD Per Capita. 

<div class = "twoC">

##### **Task 4: Compute a Trimmed Mean of Life Expectancy for Different Years**

---------------------

```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  arrange(year) %>%
  group_by(year) %>%
  summarize(Mean = mean(lifeExp, trim = 0.2)) %>%
  ungroup() %>%
  kable(., format = "html", caption = "Trimmed Mean of Life Expectancy 
  for Different Years") %>%
  kable_styling()

```

```{r, warning=FALSE, echo=FALSE}
gapminder %>%
  arrange(year) %>%
  group_by(year) %>%
  summarize(mean = mean(lifeExp, trim = 0.2)) %>%
  ggplot(., aes(year, mean))+
  geom_line(color = "dark green")+
  xlab("Year")+
  ylab("Trimmed Mean Life Expectancy (Years)")+
  ggtitle("Trimmed Mean Life (20%) Expectancy for Different Years")+
  theme_bw()

```
</div>
<div class="clearer"></div>

The table and figure above shows a trimmed mean of life expectancy among countries in different years. I have a chosen a trim fraction of 0.2 (20%). From both the table and figure, we can see that as the years increase, the trimmed mean life expectancy also increases. 
